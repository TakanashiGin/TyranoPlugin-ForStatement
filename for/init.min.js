tyrano.plugin.kag.stat.stack.for=[],tyrano.plugin.kag.tmp.for={},tyrano.plugin.kag.tag.for={vital:["name"],pm:{name:"",from:"0",to:"3",len:"",array:"",deep:"0"},start:function(pm){const TG=this.kag,f=TG.stat.f,sf=TG.variable.sf,tf=TG.variable.tf,mp=TG.stat.mp,tmp=TG.tmp.for;if("tf.index"===pm.name)return console.error('[ERROR] The "tf.index" cannot be specified in the parameter "name".'),!1;pm.len||(pm.len=parseInt(pm.to)-parseInt(pm.from)+1),pm.from=parseInt(pm.from),pm.to=parseInt(pm.to),pm.len=parseInt(pm.len);const stk={return_index:this.kag.ftag.current_order_index,return_scenario:this.kag.stat.current_scenario,is_loop:!0,index:0,length:parseInt(pm.len),pm:pm};this.kag.pushStack("for",stk);const array_str=stk.pm.array+"["+(stk.pm.from+stk.index)+"]";if(!eval(`${stk.index}<${stk.length}`)||""!==stk.pm.array&&void 0===eval(array_str)){for(let t=0;t<2e3;t++){this.kag.ftag.current_order_index++;const a=this.kag.ftag.array_tag[this.kag.ftag.current_order_index];if("nextfor"===a.name){const r=a.pm.deep||"0";if(r==pm.deep)break;if(t>1900){alert("[nextfor]が見つかりませんでした。");break}}}this.kag.ftag.nextOrder()}else eval(`${stk.pm.name} = stk.pm.array !== ''? ${array_str} : ${stk.pm.from}`),tmp.index=0,this.kag.ftag.nextOrder()}},tyrano.plugin.kag.tag.foreach={vital:["name","array"],pm:{name:"",from:"0",to:"",len:"",array:""},start:function(pm){const TG=this.kag,f=TG.stat.f,sf=TG.variable.sf,tf=TG.variable.tf,mp=TG.stat.mp;pm.len||(pm.len=pm.to?parseInt(pm.to)-parseInt(pm.from)+1:eval(pm.array).length),this.kag.ftag.startTag("for",pm)}},tyrano.plugin.kag.tag.breakfor={pm:{deep:""},start:function(t){this.kag.getStack("for").is_loop=!1;for(let t,a=0;a<2e3&&1!=(t=this.kag.ftag.nextOrderWithTag({nextfor:""}));a++)if(a>1900){alert("[nextfor]が見つかりませんでした。");break}}},tyrano.plugin.kag.tag.nextfor={pm:{deep:"0"},start:function(pm){const TG=this.kag,f=TG.stat.f,sf=TG.variable.sf,tf=TG.variable.tf,mp=TG.stat.mp,tmp=TG.tmp.for,stk=this.kag.getStack("for");stk.index++,tmp.index=stk.index;const array_str=`${stk.pm.array}[${stk.pm.from+stk.index}]`;stk.is_loop&&eval(`${stk.index} < ${stk.length}`)&&(""===stk.pm.array||void 0!==eval(array_str))?(eval(`${stk.pm.name} = stk.pm.array !== ''? ${array_str} : ${stk.pm.name} + 1`),this.kag.ftag.nextOrderWithIndex(stk.return_index,stk.return_scenario)):(this.kag.popStack("for"),this.kag.ftag.nextOrder())}},["for","foreach","breakfor","nextfor"].forEach(t=>{tyrano.plugin.kag.ftag.master_tag[t]=object(tyrano.plugin.kag.tag[t]),tyrano.plugin.kag.ftag.master_tag[t].kag=TYRANO.kag}),TYRANO.kag.ftag.master_tag.clearstack.start=function(t){if(""==t.stack)for(let t in this.kag.stat.stack)this.kag.stat.stack[t]=[];else this.kag.stat.stack[t.stack]=[];this.kag.ftag.nextOrder()};